# Estado Actual & Continuidad

## 游꿢 Prompt de Continuidad para Ma침ana

**Objetivo Principal**: Mejorar la precisi칩n del an치lisis SAST reduciendo falsos positivos en c칩digo C++

**Problemas Identificados**:
1. Cppcheck detecta `namespace` y `class` como "invalid C code" (falso positivo)
2. Archivos generados por protobuf causan ruido
3. Necesidad de mejor filtrado por tipo de archivo

**Tareas Prioritarias**:

### 1. **Mejorar Filtrado de C++** (Cr칤tico)
```python
# En sast_runner.py - mejorar el filtrado de cppcheck
def filter_cppcheck_issues(issue):
    # Ignorar "invalid C code" en archivos .cc/.cpp con namespace/class
    if "invalid C code" in issue.get("message", "").lower():
        if any(keyword in issue.get("message", "") 
               for keyword in ["namespace", "class", "protobuf"]):
            return False
    return True
```

### 2. **Excluir Archivos Generados** (Importante)
- Patrones a excluir: `*.pb.cc`, `*.pb.h`, `*_generated.*`
- Excluir archivos con comentarios "Generated by" o "This file was generated"

### 3. **Configuraci칩n de Filtros Personalizados** (Opcional)
```yaml
# config/sast_filters.yaml
cppcheck:
  exclude_patterns:
    - "*.pb.cc"
    - "*.pb.h"
  exclude_messages:
    - "invalid C code"
    - "#error This file was generated"
```

### 4. **Mejorar Detecci칩n de Lenguaje** (Opcional)
- Detectar autom치ticamente C vs C++ por extensi칩n y contenido
- Ajustar flags de herramientas seg칰n lenguaje

**Puntos de Partida para Ma침ana**:
1. Archivo a modificar: `sast_runner.py` (l칤nea ~250 donde se procesan resultados)
2. Test case: `test_vuln.c` vs `test_cpp.c`
3. Repo de prueba: `alonsoir/test-zeromq-c-` (tiene ambos problemas)

**M칠trica de 칄xito**:
- Reducir falsos positivos cr칤ticos de 13 a <5 en repositorios C++
- Mantener detecci칩n de vulnerabilidades reales (buffer overflows)

**Comando para probar**:
```bash
python tdh_unified.py analyze alonsoir/test-zeromq-c- --sast --critical-only --filter-noise --format html
```

---

쮼mpezamos por implementar el filtrado mejorado para cppcheck? 游